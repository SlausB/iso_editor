<?xml version="1.0" encoding="utf-8"?>
<s:TitleWindow xmlns:fx="http://ns.adobe.com/mxml/2009" 
               xmlns:s="library://ns.adobe.com/flex/spark" 
               xmlns:mx="library://ns.adobe.com/flex/mx"
			   title="Adjust unit"
			   minWidth="400"
			   minHeight="600"
			   >
	
	<s:Label text="Name:" x="12" y="12" />
	<s:TextArea id="_name" editable="false" x="54" y="6" height="22" />
	
	<s:List x="10" y="100" dragEnabled="true" dropEnabled="true" >
		<mx:ArrayCollection id="_available_surfaces_list_data_provider" />
	</s:List>
	
	<s:List x="200" y="100" dragEnabled="true" dropEnabled="true" >
		<mx:ArrayCollection id="_chosen_surfaces_list_data_provider" />
	</s:List>
	
	<s:Button label="Ok" x="120" y="120" click="onOk(event)" />
	<s:Button label="Cancel" x="200" y="120" click="onCancel(event)" />
	
	<fx:Script>
		<![CDATA[
import com.junkbyte.console.Cc;
import list_items.ListItem;
import mx.collections.IList;
import mx.managers.PopUpManager;
import project_data.Region;
import project_data.UnitProperties;
		
		
		private var _project:Project;
		private var _unit:UnitDesc;
		private var _main:Main;
		
		private var _unitProperties:UnitProperties = null;
		
		
		public function Init( project : Project, unit : UnitDesc, main:Main ): void
		{
			closeButton.visible = false;
			
			_project = project;
			_unit = unit;
			_main = main;
			
			_name.text = unit._template._name;
			
			_unitProperties = project.FindUnitProperties( unit, true );
			
			/*for each ( var region:Region in project._data._regions )
			{
				if ( region._type != Region.TYPE_SURFACE )
				{
					continue;
				}
				
				_surface_list.dataProvider.addItem( new RegionChoiceListItem( region ) );
			}
			
			if ( _unitProperties._region != null )
			{
				_surface_list.selectedItem = ListItem.FindListItem( _unitProperties._region, _surface_list.dataProvider );
			}*/
			
			for each ( var region : Region in _project._data._regions )
			{
				if ( region._type != Region.TYPE_SURFACE )
				{
					
				}
			}
		}
		
		private function onOk( ... args ): void
		{
			var selected:RegionChoiceListItem = _surface_list.selectedItem as RegionChoiceListItem;
			if ( selected == null )
			{
				_unitProperties._region = null;
			}
			else
			{
				_unitProperties._region = selected.region;
			}
			
			Destroy();
		}
		
		private function onCancel( ... args ): void
		{
			Destroy();
		}
		
		private function Destroy(): void
		{
			_project = null;
			_unit = null;
			_main = null;
			
			_unitProperties = null;
			
			PopUpManager.removePopUp( this );
		}
		
		
		]]>
	</fx:Script>
	
	
</s:TitleWindow>